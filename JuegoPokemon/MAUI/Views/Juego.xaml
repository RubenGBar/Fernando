<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:MAUI.VM" 
             x:Class="MAUI.Views.Juego">

    <ContentPage.BindingContext>
        <vm:Partida />
    </ContentPage.BindingContext>

    <Grid RowDefinitions="Auto,*"
          Padding="10">

        <Grid Grid.Row="0"
              IsVisible="{Binding MostrarInstrucciones}"
              Padding="20"
              BackgroundColor="Beige"
              VerticalOptions="Center"
              HorizontalOptions="Center">
            <StackLayout HorizontalOptions="Center"
                         VerticalOptions="Center"
                         Spacing="20">
                <Label Text="Ojo Cuidado"
                       FontSize="Large"
                       FontAttributes="Bold"
                       HorizontalOptions="Center" />
                <Label Text="Tednrás 5 segundos para responder cada pregunta, así que estate atento, obtendrás más puntos cuanto más rápido respondas a las preguntas. Mucha Suerte :)"
                       FontAttributes="Bold"
                       FontSize="18"
                       HorizontalOptions="Center"/>
                <Button Text="Empezar"
                        FontSize="30"
                        Command="{Binding MiCommand}"
                        HorizontalOptions="Center"/>
                <ActivityIndicator IsRunning="{Binding Cargando}"
                   IsVisible="{Binding Cargando}"
                   HorizontalOptions="Center"
                   VerticalOptions="Center"
                   Color="Black"
                   HeightRequest="40"/>
                <Label Text="Cargando..."
                        IsVisible="{Binding Cargando}"
                        FontSize="Small"
                        TextColor="Gray"
                        HorizontalOptions="Center"
                        VerticalOptions="Center"/>
            </StackLayout>
        </Grid>

        <Grid Grid.Row="1"
              IsVisible="{Binding MostrarJuego}"
              RowDefinitions="Auto,*,Auto"
              Padding="10">

            <Grid ColumnDefinitions="*,*,*"
                  RowSpacing="0"
                  ColumnSpacing="0"
                  Row="0"
                  BackgroundColor="Black"
                  Padding="10">
                <StackLayout HorizontalOptions="Center">
                    <Label Text="Tiempo"
                           TextColor="White"
                           FontAttributes="Bold"
                           HorizontalOptions="Center" />
                    <Label Text="{Binding PreguntaActual.Tiempo}"
                           TextColor="White"
                           HorizontalOptions="Center" />
                </StackLayout>

                <StackLayout Grid.Column="1" HorizontalOptions="Center">
                    <Label Text="Ronda"
                           TextColor="White"
                           FontAttributes="Bold"
                           HorizontalOptions="Center" />
                    <Label Text="{Binding Ronda}"
                           TextColor="White"
                           HorizontalOptions="Center" />
                </StackLayout>

                <StackLayout Grid.Column="2" HorizontalOptions="Center">
                    <Label Text="Puntos"
                           TextColor="White"
                           FontAttributes="Bold"
                           HorizontalOptions="Center" />
                    <Label Text="{Binding Puntos}"
                           TextColor="White"
                           HorizontalOptions="Center" />
                </StackLayout>
            </Grid>

            <StackLayout Grid.Row="1"
                         VerticalOptions="Center"
                         Spacing="20">

                <Label Text="{Binding PreguntaActual.PokemonAdivinar.Nombre}"
                       FontAttributes="Bold"
                       FontSize="24"
                       HorizontalOptions="Center" />

                <CollectionView ItemsSource="{Binding PreguntaActual.PokemonClickables}"
                                SelectionMode="Single"
                                SelectedItem="{Binding PreguntaActual.PokemonSeleccionado}"
                                x:Name="cvPokemons">
                    <CollectionView.ItemsLayout>
                        <GridItemsLayout Orientation="Vertical"
                                         Span="2"
                                         VerticalItemSpacing="10"
                                         HorizontalItemSpacing="10"/>
                    </CollectionView.ItemsLayout>
                    <CollectionView.ItemTemplate>
                        <DataTemplate>
                            <Image Source="{Binding Foto}"
                                   HeightRequest="100"
                                   WidthRequest="100"
                                   Aspect="AspectFit"
                                   BackgroundColor="LightGray"/>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>

            </StackLayout>

        </Grid>

    </Grid>

</ContentPage>